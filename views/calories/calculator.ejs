<% layout('layouts/boilerplate') %>

<div class="container my-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Page header -->
            <div class="text-center mb-4">
                <h2>üî• Calorie Calculator</h2>
                <p class="text-muted">Find out how many calories you need each day</p>
            </div>

            <!-- Calculator form -->
            <div class="card">
                <div class="card-body">
                    <!-- Show error if any -->
                    <% if (locals.error) { %>
                        <div class="alert alert-danger"><%= error %></div>
                    <% } %>
                    
                    <form action="/calories/calculate" method="POST" id="calorieForm">
                        <div class="row">
                            <!-- Basic info -->
                            <div class="col-md-6">
                                <h5 class="mb-3">Basic Info</h5>
                                
                                <!-- Age -->
                                <div class="mb-3">
                                    <label for="age" class="form-label">Age</label>
                                    <input type="number" class="form-control" id="age" name="age" 
                                           value="<%= profile ? profile.age : (locals.formData ? formData.age : '') %>"
                                           min="13" max="120" placeholder="25" required>
                                </div>
                                
                                <!-- Gender -->
                                <div class="mb-3">
                                    <label class="form-label">Gender</label>
                                    <div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="gender" id="male" value="male"
                                                   <%= profile && profile.gender === 'male' ? 'checked' : '' %> required>
                                            <label class="form-check-label" for="male">Male</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="gender" id="female" value="female"
                                                   <%= profile && profile.gender === 'female' ? 'checked' : '' %> required>
                                            <label class="form-check-label" for="female">Female</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Physical measurements -->
                            <div class="col-md-6">
                                <h5 class="mb-3">Measurements</h5>
                                
                                <!-- Height -->
                                <div class="mb-3">
                                    <label for="height" class="form-label">Height (cm)</label>
                                    <input type="number" class="form-control" id="height" name="height" 
                                           value="<%= profile ? profile.height : (locals.formData ? formData.height : '') %>"
                                           min="100" max="250" step="0.1" placeholder="175" required>
                                </div>
                                
                                <!-- Weight -->
                                <div class="mb-3">
                                    <label for="weight" class="form-label">Weight (kg)</label>
                                    <input type="number" class="form-control" id="weight" name="weight" 
                                           value="<%= profile ? profile.weight : (locals.formData ? formData.weight : '') %>"
                                           min="30" max="300" step="0.1" placeholder="70" required>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Activity level -->
                        <div class="mb-4">
                            <h5 class="mb-3">Activity Level</h5>
                            <div class="activity-options">
                                <!-- Sedentary -->
                                <div class="activity-option mb-2">
                                    <input class="form-check-input" type="radio" name="activityLevel" 
                                           id="sedentary" value="sedentary"
                                           <%= profile && profile.activityLevel === 'sedentary' ? 'checked' : '' %> required>
                                    <label class="form-check-label w-100" for="sedentary">
                                        <strong>Sedentary</strong> - Desk job, no exercise
                                        <br><small class="text-muted">Little or no physical activity</small>
                                    </label>
                                </div>
                                
                                <!-- Light -->
                                <div class="activity-option mb-2">
                                    <input class="form-check-input" type="radio" name="activityLevel" 
                                           id="light" value="light"
                                           <%= profile && profile.activityLevel === 'light' ? 'checked' : '' %> required>
                                    <label class="form-check-label w-100" for="light">
                                        <strong>Light Activity</strong> - Light exercise 1-3 days/week
                                        <br><small class="text-muted">Walking, light gym sessions</small>
                                    </label>
                                </div>
                                
                                <!-- Moderate -->
                                <div class="activity-option mb-2">
                                    <input class="form-check-input" type="radio" name="activityLevel" 
                                           id="moderate" value="moderate"
                                           <%= profile && profile.activityLevel === 'moderate' ? 'checked' : '' %> required>
                                    <label class="form-check-label w-100" for="moderate">
                                        <strong>Moderate Activity</strong> - Exercise 3-5 days/week
                                        <br><small class="text-muted">Regular gym, sports, or fitness classes</small>
                                    </label>
                                </div>
                                
                                <!-- Active -->
                                <div class="activity-option mb-2">
                                    <input class="form-check-input" type="radio" name="activityLevel" 
                                           id="active" value="active"
                                           <%= profile && profile.activityLevel === 'active' ? 'checked' : '' %> required>
                                    <label class="form-check-label w-100" for="active">
                                        <strong>Very Active</strong> - Hard exercise 6-7 days/week
                                        <br><small class="text-muted">Daily intense workouts or sports</small>
                                    </label>
                                </div>
                                
                                <!-- Very Active -->
                                <div class="activity-option mb-2">
                                    <input class="form-check-input" type="radio" name="activityLevel" 
                                           id="very_active" value="very_active"
                                           <%= profile && profile.activityLevel === 'very_active' ? 'checked' : '' %> required>
                                    <label class="form-check-label w-100" for="very_active">
                                        <strong>Extremely Active</strong> - Very hard exercise + physical job
                                        <br><small class="text-muted">Training twice daily or very physical job</small>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Submit button -->
                        <div class="text-center">
                            <button type="submit" class="btn btn-primary btn-lg px-5">
                                üßÆ Calculate My Calories
                            </button>
                            
                            <% if (profile) { %>
                                <a href="/calories/results" class="btn btn-outline-secondary btn-lg ms-2">
                                    üìä View Last Results
                                </a>
                            <% } %>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Info section -->
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="text-center mb-3">How It Works</h5>
                    <div class="row text-center">
                        <div class="col-md-4">
                            <div class="mb-3">
                                <div class="badge bg-primary rounded-circle p-3 mb-2">
                                    <span class="fs-5">1Ô∏è‚É£</span>
                                </div>
                                <h6>Calculate BMR</h6>
                                <small class="text-muted">Your body's basic energy needs at rest</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <div class="badge bg-primary rounded-circle p-3 mb-2">
                                    <span class="fs-5">2Ô∏è‚É£</span>
                                </div>
                                <h6>Add Activity</h6>
                                <small class="text-muted">Multiply by your daily activity level</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <div class="badge bg-primary rounded-circle p-3 mb-2">
                                    <span class="fs-5">3Ô∏è‚É£</span>
                                </div>
                                <h6>Set Goals</h6>
                                <small class="text-muted">Get calories for your fitness goals</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- CSS for activity selection -->
<style>
.activity-option {
    padding: 15px;
    border: 2px solid #e9ecef;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.activity-option:hover {
    border-color: #007bff;
    background-color: #f8f9fa;
}

.activity-option.selected {
    border-color: #28a745;
    background-color: #d4edda;
}

.activity-option input[type="radio"] {
    margin-right: 10px;
}
</style>

<script src="/js/calorie-calculator.js"></script>